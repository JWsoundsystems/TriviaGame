<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
    <title>Trivia Game</title>
</head>

<body>
    <div class="container">
        <div>
            <header>
                <br>
                <br>
                <h1 id="top">Trivia Game!</h1>
            </header>
            <br>

            <div id="display">30</div>
            <br>
            <h2 id="title">Super Hero Quiz</h2>

            <div name="quiz" id="quiz">

                </form>
            </div>
            <br>
            <div name="results" id="result"></div>
            <div id="image"></div>

        </div>

    </div>



    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript">

    
        var quizSurvey = document.getElementById('quiz');
        var resultOutput = document.getElementById('results');
        var submitButton = document.getElementById('submit');

        const output = [];
        let questionNumber = -1

        var number = 30;
        var intervalId;
        let score = 0



        $("#quiz").click()
        $("#submit").click(function () {
            console.log('click')
        })
        const myQuestions = [{
                question: "Who is the strongest?",
                answers: {
                    a: "Superman",
                    b: "Spiderman",
                    c: "Hulk"
                },
                correctAnswer: "c",
                images: "Hulk.jpg",
            },
            {
                question: "What is Spidermans real name",
                answers: {
                    a: "Clark Kent",
                    b: "Dave Dennison",
                    c: "Peter Parker"
                },
                correctAnswer: "c",
                images: "Spider.jpg",
            },
            {
                question: "Where is Prince from?",
                answers: {
                    a: "California",
                    b: "Kansas",
                    c: "New York",
                    d: "Minnesota"
                },
                correctAnswer: "d",
                images: "Prince.jpg",
            }

        ];

        function run() {
            clearInterval(intervalId);
            intervalId = setInterval(decrement, 3000);
        }

        function decrement() {
            $("#display").html("<div>" + number + "</div>");
            number--;

            if (number === -1) {
                stop();
                $("#result").html("Times Up, You Lose!");
                decider(true);
            }
        }

        function stop() {
            clearInterval(intervalId);
        }



        function buildQuiz() {

            myQuestions.forEach(
                (currentQuestion, questionNumber) => {
                    const answers = [];
                    for (letter in currentQuestion.answers) {

                        answers.push(
                            `<label>
                            <input class="gfy" type="radio" name="question${questionNumber}" value="${letter}">${letter} : ${currentQuestion.answers[letter]}
                            </label></br>`
                        );

                    }

                    output.push(
                        `<div class="question"> ${currentQuestion.question} </div>
                        <div class="answers"> ${answers.join('')} </div>
                        <button id="button" value=${currentQuestion.correctAnswer}>submit</button>`
                    );

                }

            );

        }

        // display quiz right away
        let choice;
        let image;
        buildQuiz();

        function happy() {
            questionNumber++;
            $("#result").empty();
            $("#image").empty();

            if (typeof myQuestions[questionNumber] === "undefined") {
                let html = `<div>You scored ${score} out of 3 trivia questions correctly!</div>`
                image = `<img id="image" src="assets/images/trophy.jpg"/>`
                $("#result").html(html);
                $("#image").html(image);
                $("#quiz").hide(html);
                $("#title").hide(html);
                $("#top").hide(html);
                $("#display").hide(html);
            } else {
                image = `<img id="image" src="assets/images/${myQuestions[questionNumber].images}"/>`
                run();
                $("#quiz").html(output[questionNumber]);
                $(".gfy").click(function () {
                    choice = $(this).val();
                })
                $("#button").click(function () {
                    // console.log(choice === correct)
                    decider();
                    stop();
                })
            }
        }

        happy();

        function decider(isTimeUp = false) {
            let correct = myQuestions[questionNumber].correctAnswer
            console.log(choice);
            if (choice === correct) {
                $("#result").html("You are Correct!");
                $("#image").html(image);
                score++;
            } else {
                $("#result").html("You are Incorrect!");
            }
            if (isTimeUp) {
                $("#result").html("Times Up Mofo")
            }

            setTimeout(happy, 2000);
            number = 30;
        }
    </script>

</body>

</html>